# 인프런 강의 스크립트 스크래퍼

이 프로젝트는 [인프런](https://www.inflearn.com/) 웹사이트의 특정 강의에서 제공하는 스크립트(자막)를 자동으로 스크래핑하여 하나의 Markdown 파일로 통합 저장하는 Python 스크립트입니다. Selenium을 사용하여 웹 브라우저를 자동화하고, BeautifulSoup을 활용하여 HTML을 파싱하며, Gradio를 통해 웹 UI를 제공합니다.

## 주요 기능

-   **웹 UI 제공:** Gradio를 사용하여 사용자가 브라우저에서 쉽게 스크립트를 실행하고 설정을 입력할 수 있습니다.
-   **자동 로그인:** UI 또는 `.env` 파일을 통해 제공된 사용자 정보를 사용하여 인프런에 자동으로 로그인합니다.
-   **강의 자동 선택 및 이동:**
    -   로그인 후 '내 학습' 페이지로 이동합니다.
    -   사용자가 지정한 강의명으로 해당 강의 페이지로 이동합니다.
-   **전체 강의 스크립트 자동 스크래핑:**
    -   강의 페이지에서 '커리큘럼' 탭을 엽니다.
    -   첫 번째 강의(영상)부터 순차적으로 마지막 강의까지 자동으로 이동하며 스크립트를 추출합니다.
    -   각 강의의 '스크립트' 탭을 열고, 필요한 경우 확인 모달을 처리합니다.
    -   스크립트 내용을 수집하고, 다음 강의로 넘어갑니다.
-   **통합 Markdown 파일 저장:**
    -   스크래핑된 모든 강의의 스크립트(타임스탬프 및 내용)를 강의 제목을 포함한 단일 Markdown 파일로 저장합니다.
    -   각 강의 내용은 Markdown 헤더(`## 강의 제목`)로 구분됩니다.
    -   저장 경로는 UI 또는 `.env` 파일을 통해 설정할 수 있으며, 파일명은 기본적으로 `강의명_전체스크립트.md` 형식입니다.
    -   파일명 중복 시 안전하게 처리합니다 (예: `_1`, `_2` 추가).

## 사전 준비 사항

1.  **Python 설치:** Python 3.8 이상 버전이 설치되어 있어야 합니다.
2.  **Chrome 브라우저:** 최신 버전의 Chrome 브라우저가 설치되어 있어야 합니다.
3.  **필수 라이브러리 설치:**
    프로젝트 루트 디렉토리에서 다음 명령어를 실행하여 필요한 모든 Python 라이브러리를 설치합니다:
    ```bash
    pip install -r requirements.txt
    ```
    `requirements.txt` 파일에는 `selenium`, `webdriver-manager`, `beautifulsoup4`, `python-dotenv`, `gradio` 등의 라이브러리 목록이 포함되어 있습니다.

## 사용 방법

1.  **`.env` 파일 설정 (권장):**
    프로젝트 루트 디렉토리에 `.env.sample` 파일이 있다면 복사하여 `.env` 파일을 생성하거나, 직접 `.env` 파일을 만듭니다. 이 파일에 자주 사용하는 기본값을 설정해두면 UI 실행 시 편리합니다.
    ```dotenv
    INFLEARN_EMAIL="YOUR_EMAIL@example.com"
    INFLEARN_PASSWORD="YOUR_PASSWORD"
    COURSE_NAME="스크래핑할 정확한 전체 강의 제목"
    OUTPUT_DIR="output_lecture_scripts"  # 스크립트를 저장할 기본 디렉토리
    # BASE_FILENAME 변수는 이제 사용되지 않으며, 강의명 기반으로 자동 생성됩니다.
    ```
    -   `INFLEARN_EMAIL`: 인프런 계정 이메일
    -   `INFLEARN_PASSWORD`: 인프런 계정 비밀번호
    -   `COURSE_NAME`: 스크래핑할 강의의 정확한 전체 제목 (UI에서도 입력 가능)
    -   `OUTPUT_DIR`: 스크립트 파일이 저장될 기본 디렉토리 (UI에서도 변경 가능)
    **중요:** `.env` 파일은 민감한 정보를 포함하므로 `.gitignore`에 의해 Git 추적에서 제외됩니다. 절대로 공개 저장소에 커밋하지 마세요.

2.  **스크립트 실행 (웹 UI 사용):**
    터미널(명령 프롬프트 또는 PowerShell 등)을 열고 프로젝트 루트 디렉토리로 이동한 후, 다음 명령어를 실행합니다:
    ```bash
    python ui.py
    ```
    -   명령을 실행하면 터미널에 Gradio 앱이 실행 중인 로컬 URL(예: `http://127.0.0.1:7860`)이 표시됩니다.
    -   웹 브라우저를 열고 해당 URL로 접속합니다.

3.  **UI에서 설정 입력 및 스크래핑 시작:**
    -   웹 UI 화면이 나타나면 다음 정보들을 입력하거나 확인합니다:
        -   **Inflearn Email:** 인프런 계정 이메일 (비어있으면 `.env` 값 사용)
        -   **Inflearn Password:** 인프런 계정 비밀번호 (비어있으면 `.env` 값 사용)
        -   **Course Name:** 스크래핑할 강의의 정확한 전체 이름 (필수 입력, 비어있으면 `.env` 값 사용)
        -   **Output Directory:** 스크립트 파일이 저장될 경로 (기본값: `output_lecture_scripts`, 비어있으면 `.env` 값 또는 기본값 사용)
        -   **Headless Mode:** 브라우저 창을 숨기고 백그라운드에서 실행할지 여부 (기본값: 체크 해제 - 브라우저 보임)
    -   정보를 모두 입력한 후 "스크래핑 시작" 버튼을 클릭합니다.
    -   스크래핑 과정 동안 UI의 로그 영역과 터미널에 진행 상황이 출력됩니다.
    -   스크래핑이 시작되면 Selenium에 의해 Chrome 브라우저 창이 자동으로 열리고 작업이 진행됩니다 (Headless 모드가 아닌 경우).

4.  **결과 확인:**
    -   스크래핑이 성공적으로 완료되면 UI의 로그 영역과 터미널에 완료 메시지 및 저장된 파일 경로가 표시됩니다.
    -   지정된 `OUTPUT_DIR` 내에 `[강의명]_total_script.md` (또는 중복 시 숫자 추가) 형식으로 파일이 생성됩니다. 이 파일에는 모든 강의의 스크립트가 Markdown 형식으로 통합 저장되어 있습니다.

## 주요 코드 구조

-   **`ui.py`:** Gradio를 사용한 웹 UI 구성 및 `app.py`의 `execute_scraping_workflow` 함수 호출.
-   **`app.py`:** 메인 스크래핑 워크플로우를 정의하는 `execute_scraping_workflow` 함수 포함. 로그인, 강의 선택, 챕터별 반복, 스크립트 추출, 파일 저장 등의 전체 과정을 관리.
-   **`navigation.py`:** Selenium을 사용하여 웹사이트 내에서 다양한 탐색 작업(페이지 이동, 요소 클릭, 탭 전환 등)을 수행하는 함수 모음.
-   **`scraper.py`:** 현재 열려 있는 강의 페이지에서 스크립트 내용을 추출하는 로직 담당.
-   **`user_config_manager.py`:** UI 입력, `.env` 파일, 기본값을 통합하여 스크립트 실행에 필요한 설정을 관리.
-   **`driver_setup.py`:** Selenium WebDriver (Chrome)를 초기화하고 headless 모드 등의 옵션을 설정.
-   **`os_utils.py`:** 파일/디렉토리 생성, 안전한 파일명 만들기 등 운영체제 관련 유틸리티 함수.
-   **`constants.py` (또는 `config.py` 내 변수들):** 일부 고정 URL, 대기 시간 등의 상수 값 정의.

## 주의 사항 및 한계점

-   **웹사이트 구조 변경:** 인프런 웹사이트의 HTML 구조나 CSS 클래스 이름이 변경되면 스크립트가 정상적으로 작동하지 않을 수 있습니다. 이 경우 `navigation.py`와 `scraper.py` 내의 CSS 선택자 및 XPath 표현식을 업데이트해야 합니다.
-   **네트워크 상태 및 속도:** 네트워크 상태나 PC 성능에 따라 `WebDriverWait`의 타임아웃 값을 코드 내에서 조절해야 할 수 있습니다 (`config.py` 또는 해당 함수 내).
-   **동적 로딩의 복잡성:** 스크립트 및 페이지 로딩 방식이 예기치 않게 변경될 경우, 현재 로직이 모든 케이스를 처리하지 못할 수 있습니다.
-   **강의명 정확성:** UI 또는 `.env` 파일에 입력하는 강의명은 인프런 사이트의 '내 학습' 페이지에 표시되는 강의 제목과 정확히 일치해야 합니다.

## 향후 개선 사항 (제안)

-   특정 섹션 또는 특정 강의만 선택적으로 스크래핑하는 기능 추가.
-   스크래핑 진행 상태를 UI에 더 상세하게 시각화 (예: 진행률 표시).
-   오류 발생 시 UI를 통한 재시도 또는 특정 단계 건너뛰기 옵션 제공.
-   다양한 웹 드라이버 지원 (현재는 Chrome에 최적화).

---

이 README 파일이 프로젝트를 이해하고 사용하는 데 도움이 되기를 바랍니다. 