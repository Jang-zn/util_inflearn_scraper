# 인프런 강의 스크립트 스크래퍼

이 프로젝트는 [인프런](https://www.inflearn.com/) 웹사이트의 특정 강의에서 제공하는 스크립트(자막)를 자동으로 스크래핑하여 Markdown 파일로 저장하는 Python 스크립트입니다. Selenium을 사용하여 웹 브라우저를 자동화하고, BeautifulSoup을 활용하여 HTML을 파싱합니다.

## 주요 기능

-   **자동 로그인:** 제공된 사용자 정보를 사용하여 인프런에 자동으로 로그인합니다.
-   **강의 스크립트 페이지 이동:** 로그인 후 '내 강의' 페이지로 이동합니다.
-   **사용자 지정 강의 선택:** 사용자가 스크래핑할 강의의 스크립트 탭으로 직접 이동한 후 스크래핑을 시작합니다.
-   **동적 콘텐츠 스크래핑:**
    -   현재 화면에 보이는 스크립트 내용을 수집합니다.
    -   스크립트의 고유 `data-index`를 기준으로 새로운 항목을 식별하고 중복 없이 저장합니다.
    -   스크립트 목록의 마지막 항목을 클릭하여 다음 스크립트 내용을 동적으로 로드합니다.
    -   더 이상 새로운 스크립트가 로드되지 않거나, 설정된 최대 시도 횟수에 도달하면 스크래핑을 안전하게 종료합니다.
-   **Markdown 파일 저장:** 수집된 모든 스크립트(타임스탬프 포함)를 `.env` 파일에 설정된 경로 및 파일명으로 저장합니다. 동일한 파일명이 존재할 경우, 파일명 뒤에 `_0`, `_1` 등을 붙여 중복을 피합니다.

## 사전 준비 사항

1.  **Python 설치:** Python 3.7 이상 버전이 설치되어 있어야 합니다.
2.  **Chrome 브라우저:** 최신 버전의 Chrome 브라우저가 설치되어 있어야 합니다.
3.  **필수 라이브러리 설치:**
    프로젝트 루트 디렉토리에서 다음 명령어를 실행하여 필요한 모든 Python 라이브러리를 한 번에 설치할 수 있습니다:
    ```bash
    pip install -r requirements.txt
    ```
    `requirements.txt` 파일에는 스크립트 실행에 필요한 `selenium`, `webdriver-manager`, `beautifulsoup4`, `python-dotenv` 등의 라이브러리 목록이 정의되어 있습니다.

## 사용 방법

1.  **`.env` 파일 설정:**
    프로젝트 루트 디렉토리에 있는 `.env.sample` 파일을 복사하여 `.env` 파일을 생성합니다. (또는 직접 `.env` 파일 생성)
    `.env` 파일을 열어 다음 환경 변수들을 실제 값으로 수정합니다:
    ```dotenv
    INFLEARN_EMAIL="YOUR_EMAIL@example.com"
    INFLEARN_PASSWORD="YOUR_PASSWORD"
    OUTPUT_DIR="output_lecture_scripts"  # 스크립트를 저장할 디렉토리 경로
    BASE_FILENAME="lecture_script"      # 저장될 파일의 기본 이름 (확장자 .md 제외)
    ```
    -   `INFLEARN_EMAIL`: 인프런 계정 이메일
    -   `INFLEARN_PASSWORD`: 인프런 계정 비밀번호
    -   `OUTPUT_DIR`: 스크립트 파일이 저장될 디렉토리 경로입니다. (기본값: `output_lecture_scripts`)
    -   `BASE_FILENAME`: 저장될 Markdown 파일의 기본 이름입니다. (기본값: `lecture_script`, 확장자 `.md`는 자동 추가)
    **중요:** `.env` 파일은 민감한 정보를 포함하므로 `.gitignore`에 의해 Git 추적에서 제외됩니다. 절대로 공개 저장소에 커밋하지 마세요.

2.  **스크립트 실행:**
    터미널(명령 프롬프트 또는 PowerShell 등)을 열고 `inflearn_scraper.py` 파일이 있는 디렉토리로 이동한 후, 다음 명령어를 실행합니다:
    ```bash
    python inflearn_scraper.py
    ```
    스크립트는 `.env` 파일에서 설정을 읽어 실행됩니다.

3.  **사용자 인터랙션:**
    -   스크립트가 실행되면 Chrome 브라우저 창이 자동으로 열리고 인프런 사이트로 이동하여 로그인을 시도합니다.
    -   로그인이 성공적으로 완료되면 '내 강의' 페이지로 자동 이동합니다.
    -   터미널에 다음과 같은 메시지가 나타납니다:
        ```
        --- 사용자 인터랙션 대기 ---
        원하는 강의의 스크립트 탭으로 직접 이동해주세요.
        완료되면 터미널에서 'y'를 입력하고 Enter를 누르세요:
        ```
    -   이때, 열려 있는 Chrome 브라우저에서 스크립트를 추출하고 싶은 강의를 선택하고, 해당 강의 페이지 내의 **'스크립트' 탭**으로 직접 이동합니다.
    -   스크립트 탭 내용이 완전히 로드된 것을 확인한 후, 터미널로 돌아와 `y`를 입력하고 Enter 키를 누릅니다.

4.  **스크래핑 진행 및 결과 확인:**
    -   'y'를 입력하면 스크립트가 자동으로 스크롤(정확히는 마지막 항목 클릭)하며 페이지 하단의 스크립트 내용을 계속해서 로드하고 수집합니다.
    -   스크래핑 진행 상황(찾은 항목 수, 현재 최대 인덱스 등)이 터미널에 실시간으로 출력됩니다.
    -   모든 스크립트 수집이 완료되면, 터미널에 완료 메시지와 함께 최종 저장된 파일 경로가 표시됩니다. (예: `my_scripts/web_dev_basics/chapter1_script.md` 또는 중복 시 `chapter1_script_0.md`). 이 파일에는 타임스탬프와 함께 추출된 모든 스크립트 내용이 Markdown 형식으로 저장되어 있습니다.

## 주요 코드 구조 (inflearn_scraper.py)

-   **환경 변수 로드 (`.env` 사용):**
    -   `python-dotenv` 라이브러리를 사용하여 스크립트 시작 시 `.env` 파일로부터 환경 변수를 로드합니다.
    -   `INFLEARN_EMAIL`, `INFLEARN_PASSWORD`, `OUTPUT_DIR`, `BASE_FILENAME` 등의 설정을 환경 변수에서 가져옵니다.
    -   `.env` 파일이 없거나 필수 정보(이메일, 비밀번호)가 누락된 경우 오류 메시지를 출력하고 종료합니다.
    -   파일 저장 시 `OUTPUT_DIR`과 `BASE_FILENAME`을 사용하며, `os` 모듈을 통해 디렉토리 생성 및 파일명 중복 처리 로직은 동일하게 적용됩니다.
-   **WebDriver 설정:** Chrome WebDriver를 초기화하고 브라우저 옵션(예: 창 최대화)을 설정합니다.
-   **로그인 로직:** 지정된 CSS 선택자를 사용하여 로그인 버튼, 이메일/비밀번호 필드, 제출 버튼을 찾아 상호작용합니다.
-   **스크래핑 루프:**
    -   `while True` 루프를 통해 반복적으로 스크립트 내용을 가져오고 처리합니다.
    -   `BeautifulSoup`으로 현재 페이지 HTML을 파싱하여 `data-index` 속성을 가진 `div` 태그들을 찾습니다.
    -   새로운 스크립트 항목만 `script_data` 딕셔너리에 저장합니다.
    -   종료 조건 (새 항목이 없거나 최대 시도 횟수 도달)을 확인합니다.
    -   가장 마지막에 로드된 스크립트 항목의 `p` 태그를 클릭하여 다음 내용을 로드합니다. (XPath 사용)
    -   클릭할 요소를 찾기 위해 여러 단계의 XPath 탐색을 시도하며, 요소가 화면에 보이도록 스크롤합니다.
-   **데이터 저장:** 스크래핑이 완료된 후 `script_data`를 정렬하여 Markdown 형식으로 파일에 저장합니다.
-   **예외 처리:** `try...except...finally` 구문을 사용하여 오류 발생 시 적절히 처리하고 항상 브라우저를 닫도록 합니다.

## 주의 사항 및 한계점

-   **웹사이트 구조 변경:** 인프런 웹사이트의 HTML 구조나 CSS 클래스 이름이 변경되면 스크립트가 정상적으로 작동하지 않을 수 있습니다. 이 경우 CSS 선택자 및 XPath 표현식을 업데이트해야 합니다.
-   **네트워크 상태 및 속도:** 네트워크 상태나 PC 성능에 따라 `WebDriverWait`의 타임아웃 값을 조절해야 할 수 있습니다.
-   **로그인 정보 하드코딩:** 현재 스크립트는 로그인 정보를 코드 내에 직접 입력하는 방식입니다. 보안상 안전하지 않으므로, 실제 사용 시에는 환경 변수, `.env` 파일, 또는 다른 안전한 방법을 사용하여 관리하는 것이 좋습니다.
-   **동적 로딩의 복잡성:** 스크립트 로딩 방식이 매우 복잡하거나 예기치 않은 방식으로 변경될 경우, 현재의 클릭 기반 로직이 모든 케이스를 처리하지 못할 수 있습니다.
-   **최대 시도 횟수:** `max_scroll_attempts` 변수는 무한 루프를 방지하기 위해 설정되었지만, 매우 긴 강의의 경우 이 값을 늘려야 할 수 있습니다.

## 향후 개선 사항 (제안)

-   로그인 정보 외부 파일 또는 환경 변수에서 읽어오도록 개선
-   스크래핑할 강의 URL을 직접 입력받는 기능 추가
-   GUI (Graphical User Interface) 추가
-   `requirements.txt` 파일 생성 (필수 라이브러리 목록화)
-   오류 처리 로직 강화 및 재시도 메커니즘 개선

---

이 README 파일이 프로젝트를 이해하고 사용하는 데 도움이 되기를 바랍니다. 